---
title: "Tapyrus Tokenã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ä»˜ä¸"
emoji: "ğŸ™"
type: "tech"
topics: ["Tapyrus"]
published: true
---

# Tapyrus Token ã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ä»˜ä¸

æ˜¨å¹´ [Tap!](https://www.shmn7iii.net/tap) ã§å®Ÿè£…ã—ãŸã€ŒNFT ã«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ã‚ªãƒ³ãƒã‚§ãƒ¼ãƒ³ã§æŒãŸã›ã‚‹æ–¹æ³•ã€ã«ã¤ã„ã¦ã€ãã‚ãã‚å¿˜ã‚Œãã†ãªã®ã§ä»Šã®ã†ã¡ã«ã¾ã¨ã‚ã‚‹ã€‚è¨˜äº‹å†…ã§ã¯ NFT ã«ã¤ã„ã¦è§¦ã‚Œã‚‹ãŒã€Reissuable Token, Non-Reissuable Token ã§ã‚‚åŒæ§˜ã®æ–¹æ³•ã§å®Ÿè£…å¯èƒ½ãªã¯ãšã€‚

### è¿½è¨˜

å®Ÿéš›ã«è©¦ã›ã‚‹ Rails ã‚¢ãƒ—ãƒªã‚’ä½œã£ã¦å…¬é–‹ã—ã¾ã—ãŸã€‚
ä»»æ„ã® Metadata ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ IPFS ã¸ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã— NFT ã‚’ç™ºè¡Œã™ã‚‹ã¾ã§ã®ä¸€é€£ã®æµã‚Œã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§è©¦ã›ã¾ã™ã€‚Docker Compose ã‚’ä½¿ã„ Rails app, tapyrusd, IPFS ãƒãƒ¼ãƒ‰ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

https://github.com/shmn7iii/tapyrus_token_metadata_sample

### çµè«–

å…ˆã«çµè«–ã€‚
ã€ŒNFT ç™ºè¡Œãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã«ã€IPFS ã¸ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸä»»æ„ Metadata ãƒ•ã‚¡ã‚¤ãƒ«ã® CID ã‚’ OP_RETURN ã®å¾Œã‚ã«å…¥ã‚ŒãŸã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã€ã‚’è¿½åŠ ã€ã—ã¾ã—ãŸã€‚

![01.jpeg](/images/f0421d4e1014d5/01.jpeg)

### å®Ÿè£…

ã¨ã¦ã‚‚ã–ã£ãã‚Šã€‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ Tap! æº–æ‹ ã€‚
ç™ºè¡Œè‡ªä½“ã¯ä»¥ä¸‹ã€‚

```ruby
# wallet = å¯¾è±¡ã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆ
# cid = å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®CID

tokens = Glueby::Contract::Token.issue_tap_nft(wallet: wallet, prefix: '', content: cid)
```

`tokens` ã«ç™ºè¡Œã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ãŒå…¥ã‚‹ã€‚ç™ºè¡Œå‡¦ç†ã¯ Glueby ã® `issue_nft` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ã‚ªãƒ¼ãƒ—ãƒ³ã‚¯ãƒ©ã‚¹ã§æ”¹é€ ã—ã¦ä½œã£ãŸ `issue_tap_nft` ã‚’åˆ©ç”¨ã€‚

`issue_tap_nft` ã‚’å«ã‚€ã‚ªãƒ¼ãƒ—ãƒ³ã‚¯ãƒ©ã‚¹ç®‡æ‰€ã¯ä»¥ä¸‹ã€‚

https://github.com/shmn7iii/tapyrus_token_metadata_sample/blob/main/lib/monkey_patches/glueby/glueby_add_issue_nft_with_metadata_method.rb

`issue_tap_nft` ã«åŠ ãˆã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ç™ºè¡Œãƒ¡ã‚½ãƒƒãƒ‰ `create_tx_for_tap_nft` ã‚‚ä½œæˆã—ãŸã€‚å®Ÿéš›ã« CID ã‚’ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã«åŠ ãˆã‚‹ä½œæ¥­ã¯ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§å‡¦ç†ã—ã¦ã„ã‚‹ã€‚ã»ã¨ã‚“ã©ã¯å…ƒã‹ã‚‰ã‚ã£ãŸ NFT ç”¨ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç™ºè¡Œãƒ¡ã‚½ãƒƒãƒ‰ã®å†…å®¹ã¨åŒã˜ã§ã‚ã‚Šã€è¿½åŠ éƒ¨åˆ†ã¯

https://github.com/shmn7iii/tapyrus_token_metadata_sample/blob/main/lib/monkey_patches/glueby/glueby_add_issue_nft_with_metadata_method.rb#L43-L45

ã®éƒ¨åˆ†ã€‚å…¥ã‚ŒãŸã„ CID ã‹ã‚‰ `script`ï¼ˆTapyrus Scriptï¼‰ã‚’ç”¨æ„ã—ã€ãã‚Œã‚’æ–°ãŸãªã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã¨ã—ã¦ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«åŠ ãˆã¦ã„ã‚‹ã€‚

script ã®ä½œæˆéƒ¨åˆ†ã«ã¤ã„ã¦ã€ã“ã“ã§ OP_RETURN ã®å¾Œã‚ã«ï¼ˆãƒšã‚¤ãƒ­ãƒ¼ãƒ‰åŒ–ã—ãŸï¼‰CID ã‚’å…¥ã‚Œè¾¼ã‚“ã  Tapyrus Script ã‚’ä½œæˆã—ã¦ã„ã‚‹ã€‚

https://github.com/shmn7iii/tapyrus_token_metadata_sample/blob/main/lib/monkey_patches/glueby/glueby_add_issue_nft_with_metadata_method.rb#L61-L69

ã“ã‚Œã§ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¯

| TxIn  | ç™ºè¡Œã«åˆ©ç”¨ã™ã‚‹ UTXO                                         |
| ----- | ----------------------------------------------------------- |
| TxOut | NFT ã‚’å«ã‚€ UTXO                                             |
|       | OP_RETURN ä»¥é™ã« CID ãŒæ ¼ç´ã•ã‚ŒãŸ Script ã‚’å«ã‚€ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ |

ã®ã‚ˆã†ãªæ§‹é€ ã«ãªã‚‹ã€‚
